function gl(t){return t.value?t.value:""}window.YSCONF={url:{com_login:{url:"",method:"post"},com_pro:{url:"/api/wechat/Weindex/pro_single_list",method:"post_data_watch"},work_image:{url:"/api/wechat/Weindex/program_work_sinimage",method:"post_data_watch"},work_matcount:{url:"/api/wechat/Weindex/program_work_matcount",method:"post_data_watch"},plan_mat:{url:"/api/wechat/Weindex/yuancai_list",method:"post_data_watch"},plan_songjian:{url:"/api/wechat/Weindex/songjian_list",method:"post_data_watch"},com_em:{url:"/api/wechat/Weindex/com_em",method:"post_data_watch"},com_ed:{url:"/api/wechat/Weindex/com_ed",method:"post_data_watch"},com_ea:{url:"/api/wechat/Weindex/com_ea",method:"post_data_watch"},user_info:{url:"/api/wechat/Weindex/getuserinfo",method:"post_data_watch"},my_info:{url:"/api/wechat/Weindex/getuserinfo",method:"post_data_watch"},gether_data:{url:"/api/wechat/Weindex/program_gether",method:"post_data_watch"},gether_save:{url:"/api/wechat/Weindex/program_gether_save",method:"post_data_watch"},jiben:{url:"/api/wechat/Weindex/pro_base",method:"post_data_watch"},jishu_info:{url:"/api/wechat/Weindex/program_tecnology_info",method:"post_data_watch"},shigong_unit:{url:"/api/wechat/Weindex/pro_shigong",method:"post_data_watch"},jianli_unit:{url:"/api/wechat/Weindex/pro_jianli",method:"post_data_watch"},jianshe_unit:{url:"/api/wechat/Weindex/pro_jianshe",method:"post_data_watch"},yc_info:{url:"/api/wechat/Weindex/com_esyc",method:"post_data_watch"},by_info:{url:"/api/wechat/Weindex/com_essj",method:"post_data_watch"},sheji_unit:{url:"/api/wechat/Weindex/pro_sheji",method:"post_data_watch"},kancha:{url:"/api/wechat/Weindex/pro_kancha",method:"post_data_watch"},othera_unit:{url:"/api/wechat/Weindex/pro_other",method:"post_data_watch"},unbindwe:{url:"/api/wechat/Weindex/unbind",method:"post_data_watch"},pwd_edit:{url:"/api/wechat/Weindex/password",method:"post_data_watch"},get_code:{url:"/api/wechat/Login/getphoneCode2",method:"post_data_watch"},tel_edit:{url:"/api/wechat/Weindex/tel",method:"post_data_watch"},my_edit:{url:"/api/wechat/Weindex/edituserinfo",method:"post_data_watch"},sin_add:{url:"/api/wechat/Weindex/sin_add",method:"post_data_watch"},pro_add:{url:"/api/wechat/Weindex/pro_add",method:"post_data_watch"},com_province:{url:"/api/ver1/Open/provwe",method:"post_data_watch"},com_city:{url:"/api/ver1/Open/citywe",method:"post_data_watch"},pro_del:{url:"/api/wechat/Weindex/pro_del",method:"post_data_watch"},sin_del:{url:"/api/wechat/Weindex/sin_del",method:"post_data_watch"},wendu_info:{url:"/api/wechat/Weindex/wendu",method:"post_data_watch"}},win:{warmtips_teacher_set:{template:"warmtips_teacher_set",type:"add",title:"温馨提示",temdata:{}}},ext:{jichu:["桩芯","承台垫层","承台","基础梁垫层","基础梁","电梯基坑垫层","电梯基坑"],zhuti:["首","二","三","四","五","六","七","八","九","十","十一","十二","十三","十四","十五","十六","十七","十八","十九","二十","二十一","二十二","二十三","二十四","二十五","二十六","二十七","二十八","二十九","三十","三十一","三十二","三十三","三十四","三十五","三十六","三十七","三十八","三十九","四十","五十一","五十二","五十三","五十四","五十五","五十六","五十七","五十八","五十九","五十"],yctypelist:[{title:"钢筋",t:"1"},{title:"水泥",t:"2"},{title:"砂",t:"3"},{title:"砖",t:"4"},{title:"装饰",t:"5"},{title:"节能",t:"6"},{title:"防水",t:"7"},{title:"水电",t:"8"},{title:"安全",t:"9"},{title:"全部",t:"0"}],ftypelist:[{title:"基础",t:"3"},{title:"主体",t:"4"},{title:"装修",t:"5"},{title:"幕墙",t:"6"},{title:"屋面",t:"7"},{title:"节能",t:"8"},{title:"给排水",t:"9"},{title:"电气",t:"10"}]}};var TouchSlide=function(t){t=t||{};var e={slideCell:t.slideCell||"#touchSlide",titCell:t.titCell||".hd li",mainCell:t.mainCell||".bd",effect:t.effect||"left",autoPlay:t.autoPlay||!1,delayTime:t.delayTime||200,interTime:t.interTime||2500,defaultIndex:t.defaultIndex||0,titOnClassName:t.titOnClassName||"on",autoPage:t.autoPage||!1,prevCell:t.prevCell||".prev",nextCell:t.nextCell||".next",pageStateCell:t.pageStateCell||".pageState",pnLoop:"undefined "==t.pnLoop||t.pnLoop,startFun:t.startFun||null,endFun:t.endFun||null,switchLoad:t.switchLoad||null},a=document.getElementById(e.slideCell.replace("#",""));if(!a)return!1;var i=function(t,e){t=t.split(" ");var a=[];e=e||document;var i=[e];for(var n in t)0!=t[n].length&&a.push(t[n]);for(var n in a){if(0==i.length)return!1;var o=[];for(var s in i)if("#"==a[n][0])o.push(document.getElementById(a[n].replace("#","")));else if("."==a[n][0])for(var c=i[s].getElementsByTagName("*"),d=0;d<c.length;d++){var r=c[d].className;r&&-1!=r.search(new RegExp("\\b"+a[n].replace(".","")+"\\b"))&&o.push(c[d])}else for(var c=i[s].getElementsByTagName(a[n]),d=0;d<c.length;d++)o.push(c[d]);i=o}return 0!=i.length&&i[0]!=e&&i},n=function(t,e){var a=document.createElement("div");a.innerHTML=e,a=a.children[0];var i=t.cloneNode(!0);return a.appendChild(i),t.parentNode.replaceChild(a,t),f=i,a},o=function(t,e){!t||!e||t.className&&-1!=t.className.search(new RegExp("\\b"+e+"\\b"))||(t.className+=(t.className?" ":"")+e)},s=function(t,e){!t||!e||t.className&&-1==t.className.search(new RegExp("\\b"+e+"\\b"))||(t.className=t.className.replace(new RegExp("\\s*\\b"+e+"\\b","g"),""))},c=e.effect,d=i(e.prevCell,a)[0],r=i(e.nextCell,a)[0],m=i(e.pageStateCell)[0],f=i(e.mainCell,a)[0];if(!f)return!1;var p,h,u=f.children.length,l=i(e.titCell,a),_=l?l.length:u,g=e.switchLoad,w=parseInt(e.defaultIndex),y=parseInt(e.delayTime),v=parseInt(e.interTime),b="false"!=e.autoPlay&&0!=e.autoPlay,k="false"!=e.autoPage&&0!=e.autoPage,x="false"!=e.pnLoop&&0!=e.pnLoop,j=w,$=null,T=null,z=null,S=0,C=0,I=0,O=0,N=/hp-tablet/gi.test(navigator.appVersion),W="ontouchstart"in window&&!N,D=W?"touchstart":"mousedown",L=W?"touchmove":"",E=W?"touchend":"mouseup",P=f.parentNode.clientWidth,V=u;if(0==_&&(_=u),k){_=u,l=l[0],l.innerHTML="";var M="";if(1==e.autoPage||"true"==e.autoPage)for(var q=0;_>q;q++)M+="<li>"+(q+1)+"</li>";else for(var q=0;_>q;q++)M+=e.autoPage.replace("$",q+1);l.innerHTML=M,l=l.children}"leftLoop"==c&&(V+=2,f.appendChild(f.children[0].cloneNode(!0)),f.insertBefore(f.children[u-1].cloneNode(!0),f.children[0])),p=n(f,'<div class="tempWrap" style="overflow:hidden; position:relative;"></div>'),f.style.cssText="width:"+V*P+"px;position:relative;overflow:hidden;padding:0;margin:0;";for(var q=0;V>q;q++)f.children[q].style.cssText="display:table-cell;vertical-align:top;width:"+P+"px";var F=function(){"function"==typeof e.startFun&&e.startFun(w,_)},A=function(){"function"==typeof e.endFun&&e.endFun(w,_)},B=function(t){var e=("leftLoop"==c?w+1:w)+t,a=function(t){for(var e=f.children[t].getElementsByTagName("img"),a=0;a<e.length;a++)e[a].getAttribute(g)&&(e[a].setAttribute("src",e[a].getAttribute(g)),e[a].removeAttribute(g))};if(a(e),"leftLoop"==c)switch(e){case 0:a(u);break;case 1:a(u+1);break;case u:a(0);break;case u+1:a(1)}},Y=function(){P=p.clientWidth,f.style.width=V*P+"px";for(var t=0;V>t;t++)f.children[t].style.width=P+"px";var e="leftLoop"==c?w+1:w;R(-e*P,0)};window.addEventListener("resize",Y,!1);var R=function(t,e,a){a=a?a.style:f.style,a.webkitTransitionDuration=a.MozTransitionDuration=a.msTransitionDuration=a.OTransitionDuration=a.transitionDuration=e+"ms",a.webkitTransform="translate("+t+"px,0)translateZ(0)",a.msTransform=a.MozTransform=a.OTransform="translateX("+t+"px)"},J=function(t){switch(c){case"left":w>=_?w=t?w-1:0:0>w&&(w=t?0:_-1),null!=g&&B(0),R(-w*P,y),j=w;break;case"leftLoop":null!=g&&B(0),R(-(w+1)*P,y),-1==w?(T=setTimeout(function(){R(-_*P,0)},y),w=_-1):w==_&&(T=setTimeout(function(){R(-P,0)},y),w=0),j=w}F(),z=setTimeout(function(){A()},y);for(var a=0;_>a;a++)s(l[a],e.titOnClassName),a==w&&o(l[a],e.titOnClassName);0==x&&(s(r,"nextStop"),s(d,"prevStop"),0==w?o(d,"prevStop"):w==_-1&&o(r,"nextStop")),m&&(m.innerHTML="<span>"+(w+1)+"</span>/"+_)};if(J(),b&&($=setInterval(function(){w++,J()},v)),l)for(var q=0;_>q;q++)!function(){var t=q;l[t].addEventListener("click",function(){clearTimeout(T),clearTimeout(z),w=t,J()})}();r&&r.addEventListener("click",function(){(1==x||w!=_-1)&&(clearTimeout(T),clearTimeout(z),w++,J())}),d&&d.addEventListener("click",function(){(1==x||0!=w)&&(clearTimeout(T),clearTimeout(z),w--,J())});var H=function(t){clearTimeout(T),clearTimeout(z),h=void 0,I=0;var e=W?t.touches[0]:t;S=e.pageX,C=e.pageY,f.addEventListener(L,X,!1),f.addEventListener(E,G,!1)},X=function(t){if(!W||!(t.touches.length>1||t.scale&&1!==t.scale)){var e=W?t.touches[0]:t;if(I=e.pageX-S,O=e.pageY-C,"undefined"==typeof h&&(h=!!(h||Math.abs(I)<Math.abs(O))),!h){switch(t.preventDefault(),b&&clearInterval($),c){case"left":(0==w&&I>0||w>=_-1&&0>I)&&(I=.4*I),R(-w*P+I,0);break;case"leftLoop":R(-(w+1)*P+I,0)}null!=g&&Math.abs(I)>P/3&&B(I>-0?-1:1)}}},G=function(t){0!=I&&(t.preventDefault(),h||(Math.abs(I)>P/10&&(I>0?w--:w++),J(!0),b&&($=setInterval(function(){w++,J()},v))),f.removeEventListener(L,X,!1),f.removeEventListener(E,G,!1))};f.addEventListener(D,H,!1)};window.fac={changeClass:function(t){window.event.stopPropagation(),this[t]=!this[t]},binditem:function(){$(document).on("click",".js_item",function(){var t=$(this).data("id");window.pageManager.go(t)}),$(document).on("click",".js_back",function(){var t=$(this).data("id");window.pageManager.back(t)})},changeopen:function(t,e){if($a=$(t).find(".weui-mask"),"all"==e)this.prosta=!1,this.sinsta=!1,$a.fadeOut(300);else{var a="prosta"==e?"sinsta":"prosta";this[a]=!1,this[e]=!this[e];this[e]?$a.fadeIn(300):$a.fadeOut(300)}},setcode:function(t){var e={prcodeid:"",scodeid:"",prname:"",sname:"",proindex:0,sinindex:0};if(t.com_pro.data.datalist.length>0){var a=t.com_pro.data.datalist[0];if(e.prcodeid=a.codeid,e.prname=a.prname,a.sinchl.datalist.length>0){var i=a.sinchl.datalist[0];e.scodeid=i.codeid,e.sname=i.sname}}fac.setstore("sitedata",e)},afterloaddo:function(t,e){1==t.com_pro.status?("原材"==fac.getsname&&fac.setcode(t),e(t),fac.binditem()):(fac.load(1),t.com_pro.done=function(t){fac.setcode(t),e(t),fac.load(0),fac.binditem(),t.com_pro.data.datalist.length>0||fac.showlip("请先创建工程及子单位！",3e3)},t.com_pro.watch.time=fac.time())},setcodeid:function(t,e){fac.setstore("wecodeid",t),fac.setstore("stype",e)},showlip:function(t,e){var a=e?e:2e3;"none"==$("#lip").css("display")&&($("#lip").find(".con").html(t),$("#lip").fadeIn(200),setTimeout(function(){$("#lip").fadeOut(200)},a))},load:function(t){if(!t||"none"==$(".weui-loadmore").css("display")){t?$(".weui-loadmore").fadeIn(200):$(".weui-loadmore").fadeOut(200)}},bigload:function(t,e){var a=e?e:"数据加载中";if($("#loadingToast").find("p").html(a),!t||"none"==$("#loadingToast").css("display")){t?$("#loadingToast").fadeIn(100):$("#loadingToast").fadeOut(100);setTimeout(function(){$("#loadingToast").fadeOut(100)},1e4)}},bigdone:function(t){},before:function(t,e){fac.bigload(1);var a=fac.getstore("sitedata");t[e].params={codeid:a.prcodeid}},done:function(t){setTimeout(function(){fac.bigload(0)},600)},getprname:function(){return fac.getstore("sitedata").prname},getsname:function(){return fac.getstore("sitedata").sname},yschk:function(t,e){var a={codeid:t.codeid};a[e]=0==t[e]?1:0;var i=YSCONF.url.com_em.url;fac.post(i,a,function(i){1==i.code?(t[e]=a[e],$.toptip("保存成功","success")):$.toptip("更新失败","error")})},dore:function(t,e){1==t.code?($.toptip("保存成功","success"),setTimeout(function(){window.pageManager.back(e)},1e3)):$.toptip(t.msg+",保存失败","error")},coverobj:function(t,e,a){for(var i in e)!e.hasOwnProperty(i)||t.hasOwnProperty(i)&&!a||(t[i]=e[i]);return t},dozushu:function(t){var e=[];for(i=0;i<t;i++)e.push({val:""});return e},spl:function(t,e){if(!t)return"";var a=t.split(","),i=a[e]?a[e]:"";return i},seturl:function(t){var e=YSCONF.url[t].url,a=e,i={url:a,method:YSCONF.url[t].method};return i},loginpost:function(t,e,a){$.ajax({url:e,async:!1,type:"POST",data:t,dataType:"json",success:function(t){"function"==typeof a&&a(t)},error:function(t){"function"==typeof a&&a(t)}})},post:function(t,e,a){$.ajax({url:t,async:!1,type:"POST",data:e,dataType:"json",success:function(t){"function"==typeof a&&(t.code===-1?setTimeout(function(){window.location.href="/wap/login.html"},1e3):a(t))},error:function(t){"function"==typeof a&&a(t)}})},get:function(t,e,a){$.ajax({url:t,async:!1,type:"GET",data:e,dataType:"json",success:function(t){"function"==typeof a&&(t.code===-1?setTimeout(function(){window.location.href="/wap/login.html"},1e3):a(t))},error:function(t){"function"==typeof a&&a(t)}})},setCookie:function(t,e){var a=30,i=new Date;i.setTime(i.getTime()+24*a*60*60*1e3),document.cookie=t+"="+escape(e)+";expires="+i.toGMTString()},getCookie:function(t){return document.cookie.length>0&&(c_start=document.cookie.indexOf(t+"="),c_start!=-1)?(c_start=c_start+t.length+1,c_end=document.cookie.indexOf(";",c_start),c_end==-1&&(c_end=document.cookie.length),unescape(document.cookie.substring(c_start,c_end))):""},bigload:function(t,e){var a=e?e:"数据加载中";if($("#loadingToast").find("p").html(a),!t||"none"==$("#loadingToast").css("display")){t?$("#loadingToast").fadeIn(100):setTimeout(function(){$("#loadingToast").fadeOut(100)},1e3);setTimeout(function(){$("#loadingToast").fadeOut(100)},1e4)}},newWebupload:function(t,e,a,i){t=WebUploader.create({auto:!0,swf:"./js/webupload/Uploader.swf",server:"/api/ver1/index/uploadImage",pick:""+e,accept:{title:"Files",mimeTypes:"image/*"},resize:!1,chunked:!0,chunkSize:524288,fileNumLimit:524288e3}),t.on("fileQueued",function(t){fac.bigload(1,"上传中…")}),t.on("uploadSuccess",function(t,e){a(t,e)}),t.on("uploadError",function(t,e){i(t,e)})},delCookie:function(t){var e=new Date;e.setTime(e.getTime()-1);var a=getCookie(t);null!==a&&(document.cookie=t+"="+a+";expires="+e.toGMTString())},numtotime:function(t){var e="";if(parseInt(t)>0){var a=new Date(t),i=a.getYear()+1900,n=a.getMonth()+1;n=n<10?"0"+n:n;var o=a.getDate();return o=o<10?"0"+o:o,i+"-"+n+"-"+o}return e},getDatezh:function(t){var e=new Date(parseInt(t)).toLocaleString();return e},getDateen:function(t){if(0===t)return"";var e=new Date(parseInt(t)).toLocaleString().replace(/年|月/g,"-").replace(/日/g," ");return e},time:function(t){var e=t?Date.parse(new Date(t)):Date.parse(new Date);return e},setstore:function(t,e){return e="object"==typeof e?JSON.stringify(e):e,localStorage.setItem(t,e),!0},getstore:function(t){var e="";try{e=localStorage.getItem(t),e=JSON.parse(e)}catch(a){e=localStorage.getItem(t)}return e},unsetstore:function(t){return localStorage.removeItem(t),!0},ysfetch:function(t,e){if(t&&e){var a=fac.seturl(e);fac[a.method](t,e)}},yssend:function(t,e,a){var i=fac.seturl(e);if(t[e].watch.time){if("function"==typeof t[e].before){var n=t[e].before(t);if(n===!1)return!1}var o=t[e].params||{};fac[a](i.url,o,function(a){t[e].status=1,t[e].data="1"==a.code?a.data:{},"function"==typeof t[e].done&&t[e].done(t,a)})}},yssendwatch:function(t,e,a){var i=fac.seturl(e),n=e+".watch.time";t.$watch(n,function(){if(t[e].watch.time){if("function"==typeof t[e].before){var n=t[e].before(t);if(n===!1)return!1}var o=t[e].params||{};$("#test").html(JSON.stringify(o)),fac[a](i.url,o,function(a){t[e].status=1,t[e].data="1"==a.code?a.data:{},"function"==typeof t[e].done&&t[e].done(t,a)})}},{deep:!0})},get_data:function(t,e){fac.yssend(t,e,"get")},post_data:function(t,e){fac.yssend(t,e,"post")},get_data_watch:function(t,e){fac.yssendwatch(t,e,"get")},post_data_watch:function(t,e){fac.yssendwatch(t,e,"post")},testphone:function(t){var e=/^(((13[0-9]{1})|(15[0-9]{1})|(18[0-9]{1})|(17[0-9]{1})|145|147|159|153)+\d{8})$/;return!!e.test(t)},msg:function(t,e){e=e?e:2,layer.open({content:t,skin:"msg",time:e})},domatchart:function(t,e){var a={title:{text:e,textStyle:{fontSize:"16"}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{y:"25",x:"right",data:["已送","未送","漏送","异常"]},grid:{left:"3%",right:"4%",bottom:"3%",top:"50",containLabel:!0},xAxis:{type:"value"},yAxis:{type:"category",data:t.name},series:[{name:"已送",type:"bar",stack:"总量",label:{normal:{show:!0,formatter:gl,position:"insideRight"}},itemStyle:{normal:{color:"#00cc33"}},data:t.ys},{name:"未送",type:"bar",stack:"总量",label:{normal:{show:!0,formatter:gl,position:"insideRight"}},itemStyle:{normal:{color:"#BBB"}},data:t.ws},{name:"漏送",type:"bar",stack:"总量",label:{normal:{show:!0,formatter:gl,position:"insideRight"}},itemStyle:{normal:{color:"#FF6666"}},data:t.ls}]},i=echarts.init(document.getElementById("barone"),"vintage");i.setOption(a),i.on("click",function(t){console.log(t.name)}),i.on("legendselectchanged",function(t){return!1})},hntchart:function(t,e){var a={title:{text:e,textStyle:{fontSize:"16"}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{y:"25",x:"right",data:["已送","未送","漏送","异常"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"value"},yAxis:{type:"category",data:t.name},series:[{name:"已送",type:"bar",stack:"总量",label:{normal:{show:!0,formatter:gl,position:"insideRight"}},itemStyle:{normal:{color:"#00cc33"}},data:t.ys},{name:"未送",type:"bar",stack:"总量",label:{normal:{show:!0,formatter:gl,position:"insideRight"}},itemStyle:{normal:{color:"#bbbbbb"}},data:t.ws},{name:"漏送",type:"bar",stack:"总量",label:{normal:{show:!0,formatter:gl,position:"insideRight"}},itemStyle:{normal:{color:"#FF6666"}},data:t.ls},{name:"异常",type:"bar",stack:"总量",label:{normal:{show:!0,formatter:gl,position:"insideRight"}},itemStyle:{normal:{color:"#F93"}},data:t.yc}]},i=echarts.init(document.getElementById("bartwo"),"vintage");i.setOption(a)}},$(function(){function t(){var t=function(){try{return document.createEvent("TouchEvent"),!0}catch(t){return!1}}(),e=$.fn.on;$.fn.on=function(){if(/click/.test(arguments[0])&&"function"==typeof arguments[1]&&t){var a,i=arguments[1];e.apply(this,["touchstart",function(t){a=t.changedTouches[0].clientY}]),e.apply(this,["touchend",function(t){Math.abs(t.changedTouches[0].clientY-a)>10||(t.preventDefault(),i.apply(this,[t]))}])}else e.apply(this,arguments);return this}}function e(){/Android/gi.test(navigator.userAgent)&&window.addEventListener("resize",function(){"INPUT"!=document.activeElement.tagName&&"TEXTAREA"!=document.activeElement.tagName||window.setTimeout(function(){document.activeElement.scrollIntoViewIfNeeded()},0)})}function a(){for(var t={},e=$('script[type="text/html"]'),a=$(window).height(),i=0,n=e.length;i<n;++i){var s=e[i],c=s.id.replace(/tpl_/,"");t[c]={name:c,url:"#"+c,template:"#"+s.id}}t.home.url="#";for(var d in t)o.push(t[d]);o.setPageAppend(function(t){var e=t.find(".page__ft");e.length<1||(e.position().top+e.height()<a?e.addClass("j_bottom"):e.removeClass("j_bottom"))}).setDefault("home").init()}function i(){t(),e(),a(),window.pageManager=o,window.home=function(){location.hash=""}}var n;$.toptip=function(t,e,a){if(t){"string"==typeof e&&(a=e,e=void 0),e=e||2e3;var i=a?"bg-"+a:"bg-danger",o=$(".weui_toptips").remove();o=$('<div class="weui_toptips"></div>').appendTo(document.body),o.html(t),o[0].className="weui_toptips "+i,clearTimeout(n),o.hasClass("weui_toptips_visible")||(o.show().width(),o.addClass("weui_toptips_visible")),n=setTimeout(function(){o.removeClass("weui_toptips_visible"),o.remove()},e)}};var o={$container:$("#container"),_pageStack:[],_configs:[],_pageAppend:function(){},_defaultPage:null,_pageIndex:1,setDefault:function(t){return this._defaultPage=this._find("name",t),this},setPageAppend:function(t){return this._pageAppend=t,this},init:function(){var t=this;$(window).on("hashchange",function(){var e=history.state||{},a=0===location.hash.indexOf("#")?location.hash:"#",i=t._find("url",a)||t._defaultPage;e._pageIndex<=t._pageIndex||t._findInStack(a)?t._back(i):t._go(i)}),history.state&&history.state._pageIndex&&(this._pageIndex=history.state._pageIndex),this._pageIndex--;var e=0===location.hash.indexOf("#")?location.hash:"#",a=t._find("url",e)||t._defaultPage;return this._go(a),this},push:function(t){return this._configs.push(t),this},go:function(t){var e=this._find("name",t);e&&(location.hash=e.url)},_go:function(t){this._pageIndex++,history.replaceState&&history.replaceState({_pageIndex:this._pageIndex},"",location.href);var e=$(t.template).html(),a=$(e).addClass("slideIn").addClass(t.name);return a.on("animationend webkitAnimationEnd",function(){a.removeClass("slideIn").addClass("js_show")}),this.$container.append(a),this._pageAppend.call(this,a),this._pageStack.push({config:t,dom:a}),main[t.name]?main[t.name]():"",t.isBind||this._bind(t),this},back:function(){history.back()},_back:function(t){this._pageIndex--;var e=this._pageStack.pop();if(e){var a=0===location.hash.indexOf("#")?location.hash:"#",i=this._findInStack(a);if(!i){var n=$(t.template).html(),o=$(n).addClass("js_show").addClass(t.name);o.insertBefore(e.dom),t.isBind||this._bind(t),this._pageStack.push({config:t,dom:o})}return e.dom.addClass("slideOut").on("animationend webkitAnimationEnd",function(){e.dom.remove()}),this}},_findInStack:function(t){for(var e=null,a=0,i=this._pageStack.length;a<i;a++){var n=this._pageStack[a];if(n.config.url===t){e=n;break}}return e},_find:function(t,e){for(var a=null,i=0,n=this._configs.length;i<n;i++)if(this._configs[i][t]===e){a=this._configs[i];break}return a},_bind:function(t){var e=t.events||{};for(var a in e)for(var i in e[a])this.$container.on(i,a,e[a][i]);t.isBind=!0}};i()}),$(function(){$(window).height()}),window.YSPORT={};var OBJ={data:{sitedata:{},com_pro:{status:0,data:[],params:{},watch:{time:0}}}};window.mainvue=new Vue(OBJ),fac.ysfetch(mainvue,"com_pro"),window.main={home:function(){function t(t){window.homevm=new Vue({el:"#myprolist",data:{prodata:t.com_pro.data.datalist},methods:{nopro:function(){alert("请先创建工程及子单位!")},pronum:function(t){var e=0;return this.prodata.map(function(t){0==t.isdel&&(e+=1)}),e},checkpro:function(t){var e=fac.getstore("sitedata");this.prname=this.prodata[t].prname,e.prname=this.prname,e.proindex=t,e.prcodeid=this.prodata[t].codeid,this.prodata[t].sinchl.datalist.length>0?(e.sname=this.prodata[t].sinchl.datalist[0].sname,e.scodeid=this.prodata[t].sinchl.datalist[0].codeid):(e.sname="",e.scodeid=""),fac.setstore("sitedata",e)}}}),TouchSlide({slideCell:"#focus",titCell:".hd ul",mainCell:".bd ul",effect:"leftLoop",autoPlay:!0,autoPage:!0}),fac.bigload(0)}fac.bigload(1),setTimeout(function(){fac.afterloaddo(mainvue,t)},300)},user:function(){var t={el:"#userbody",data:{ut:["","超级管理员","普通管理员","宇杉会员"],user_info:{status:0,data:[],params:{},watch:{time:0}},unbindwe:{status:0,data:[],params:{type:3},watch:{time:0}}},methods:{unbind:function(){e.unbindwe.watch.time=fac.time()}}},e=new Vue(t);fac.ysfetch(e,"user_info"),fac.ysfetch(e,"unbindwe"),e.user_info.watch.time=fac.time()},myinfo:function(){var t={el:"#mybody",data:{my_info:{status:0,data:{},params:{},watch:{time:0}},my_edit:{status:0,data:{},params:{},watch:{time:0}}},methods:{save:function(){e.my_edit.before=function(t){return e.my_info.data.nicheng?void(e.my_edit.params=e.my_info.data):($.toptip("请填写昵称！","warning"),!1)},e.my_edit.done=function(t,e){fac.dore(e,"user")},setTimeout(function(){e.my_edit.watch.time=fac.time()},500)}}},e=new Vue(t);fac.ysfetch(e,"my_info"),fac.ysfetch(e,"my_edit"),e.my_info.watch.time=fac.time()},pwd:function(){var t={el:"#pwdbody",data:{tempwd:{oldpasswd:"",newpasswd:"",newpasswdtwo:""},pwd_edit:{status:0,data:{},params:{},watch:{time:0}}},methods:{save:function(){e.pwd_edit.before=function(t){return""==$.trim(t.tempwd.oldpasswd)?($.toptip("旧密码不能少于六位!","warning"),!1):$.trim(t.tempwd.newpasswd).length<6?($.toptip("新密码不能少于六位!","warning"),!1):$.trim(t.tempwd.newpasswd)!=$.trim(t.tempwd.newpasswdtwo)?($.toptip("两次密码不一致!","warning"),!1):(t.tempwd.oldpasswd=MD5(t.tempwd.oldpasswd),t.tempwd.newpasswd=MD5(t.tempwd.newpasswd),t.tempwd.newpasswdtwo=MD5(t.tempwd.newpasswdtwo),void(t.pwd_edit.params=t.tempwd))},e.pwd_edit.done=function(t,e){fac.dore(e,"user")},e.pwd_edit.watch.time=fac.time()}}},e=new Vue(t);fac.ysfetch(e,"pwd_edit")},tel:function(){var t={el:"#telbody",data:{itime:0,temtel:{tel:"",phcode:""},tel_edit:{status:0,data:{},params:{},watch:{time:0}},get_code:{status:0,data:{},params:{},watch:{time:0}}},methods:{sendcode:function(){_this=this,e.get_code.before=function(t){var e=fac.testphone(t.temtel.tel);return e?void(t.get_code.params=t.temtel):($.toptip("手机号码格式错误!","warning"),!1)},e.get_code.done=function(t,e){if(1==e.code){_this.itime=60;var a=setInterval(function(){_this.itime-=1,0==_this.itime&&clearInterval(a)},1e3)}else $.toptip(e.msg,"warning")},e.get_code.watch.time=fac.time()},save:function(){e.tel_edit.before=function(t){t.tel_edit.params=t.temtel},e.tel_edit.done=function(t,e){fac.dore(e,"user")},e.tel_edit.watch.time=fac.time()}}},e=new Vue(t);fac.ysfetch(e,"tel_edit"),fac.ysfetch(e,"get_code")},shangxian:function(){var t={el:"#tuijianbody",data:{my_info:{status:0,data:{},params:{},watch:{time:0}}}},e=new Vue(t);fac.ysfetch(e,"my_info"),e.my_info.watch.time=fac.time()},reg:function(){},bind:function(){},sin:function(){function t(t){window.sinlistvm=new Vue({el:"#sinbody",data:{prosta:!1,proindex:a,sinindex:"",prodata:t.com_pro.data.datalist,prname:fac.getprname(),sname:"",showdel:0,prcode:"",scode:"",pro_del:{data:{},params:{},watch:{time:0}},sin_del:{data:{},params:{},watch:{time:0}}},methods:{yschk:fac.yschk,changeopen:fac.changeopen,selectitem:function(t,e){t.map(function(t){t.check=0}),t[e].check=t[e].check?0:1,this.scode=t[e].codeid,this.sname=t[e].sname,this.sinindex=e,this.showdel=t[e].check},delpro:function(t){var e=fac.getstore("sitedata"),a=this;$("#iosDialog1").fadeIn(200),$("#iosDialog1").find("#diatext").html("确定要删除"+e.prname+"么？"),$(".dialogsyes").unbind(),$(".dialogsyes").on("click",function(){$(this).parents(".js_dialog").fadeOut(200),sinlistvm.pro_del.before=function(t){return""==e.prcodeid?($.toptip("请选择工程","warning"),!1):void(t.pro_del.params={codeid:e.prcodeid})},sinlistvm.pro_del.done=function(t,e){1==e.code?(homevm.prodata[a.proindex].isdel=1,$.toptip("删除成功","success"),window.pageManager.back("home")):$.toptip(e.msg+",删除失败","error")},sinlistvm.pro_del.watch.time=fac.time()}),$(".dialogsno").on("click",function(){$(this).parents(".js_dialog").fadeOut(200)})},delsin:function(t){var e=(fac.getstore("sitedata"),this);$("#iosDialog1").fadeIn(200),$("#iosDialog1").find("#diatext").html("确定要删除"+this.sname+"么？"),$(".dialogsyes").unbind(),$(".dialogsyes").on("click",function(){$(this).parents(".js_dialog").fadeOut(200),sinlistvm.sin_del.before=function(t){return""==e.scode?($.toptip("请选择子单位","warning"),!1):void(t.sin_del.params={codeid:e.scode})},sinlistvm.sin_del.done=function(a,i){1==i.code?(e.showdel=0,t[e.sinindex].isdel=1,$.toptip("删除成功","success")):$.toptip("删除失败","error")},sinlistvm.sin_del.watch.time=fac.time()}),$(".dialogsno").on("click",function(){$(this).parents(".js_dialog").fadeOut(200)})},checkpro:function(t){this.proindex=t,this.prosta=!1,fac.changeopen("#sinbody","all");var e=fac.getstore("sitedata");this.prname=this.prodata[t].prname,this.prcode=this.prodata[t].codeid,e.prname=this.prname,e.prcodeid=this.prodata[t].codeid,this.prodata[t].sinchl.datalist.length>0?(e.sname=this.prodata[t].sinchl.datalist[0].sname,e.scodeid=this.prodata[t].sinchl.datalist[0].codeid):(e.sname="",e.scodeid=""),fac.setstore("sitedata",e)},checksin:function(t){this.sinindex=t,this.prname=this.prodata[this.proindex].prname,this.sname=this.prodata[this.proindex].sinchl.datalist[this.sinindex].sname;var e=fac.getstore("sitedata");e.prcodeid=this.prodata[this.proindex].codeid,e.scodeid=this.prodata[this.proindex].sinchl.datalist[this.sinindex].codeid,e.prname=this.prname,e.sname=this.sname,e.proindex=this.proindex,e.sinindex=this.sinindex,fac.setstore("sitedata",e)}}}),fac.ysfetch(sinlistvm,"pro_del"),fac.ysfetch(sinlistvm,"sin_del")}var e=fac.getstore("sitedata"),a=e.proindex;e.sinindex;fac.afterloaddo(mainvue,t)},addsin:function(){var t=new Vue({el:"#addsinbody",data:{prname:fac.getprname(),sin_add:{status:0,data:{codeid:"",sname:"",jiegou:1,zhuti:"",jichu:"",sinimg:"",cengshu:""},params:{},watch:{time:0},done:fac.done}},methods:{createbuwei:function(){var t=parseInt(this.sin_add.data.cengshu);if(!t)return fac.showlip("层数不能为空"),!1;if(t>50)return fac.showlip("层数不能超过50层"),!1;this.sin_add.data.jichu=YSCONF.ext.jichu.join("\n");for(var e=[],a=0;a<t;a++){var i=YSCONF.ext.zhuti[a]+"层梁板";e.push(i);var n="1"==this.sin_add.data.jiegou?"柱":"墙柱",o=YSCONF.ext.zhuti[a]+"层"+n;e.push(o)}e.push("屋面梁板"),this.sin_add.data.zhuti=e.join("\n")},sin_addsave:function(){t.sin_add.before=function(t){var e=fac.getstore("sitedata");return""==t.sin_add.data.sname?(fac.showlip("请输入工程名称"),!1):""==t.sin_add.data.cengshu?(fac.showlip("请输入层数"),!1):""==t.sin_add.data.jichu?(fac.showlip("请输入基础部位"),!1):""==t.sin_add.data.zhuti?(fac.showlip("请输入主体部位"),!1):(fac.bigload(1),t.sin_add.params=t.sin_add.data,void(t.sin_add.params.codeid=e.prcodeid))},t.sin_add.done=function(t,e){fac.bigload(0),mainvue.com_pro.done=function(t,e){sinlistvm.prodata=t.com_pro.data.datalist,fac.setcode(t)},mainvue.com_pro.watch.time=fac.time(),fac.dore(e,"sin")},t.sin_add.watch.time=fac.time()}}});fac.ysfetch(t,"sin_add"),setTimeout(function(){fac.newWebupload("headerupload","#localPicker3",function(e,a){fac.bigload(0,"上传中…"),1==a.code&&(t.sin_add.data.sinimg=a.url)},function(t){console.log("error")})},300)},editsin:function(){function t(t){var e=new Vue({el:"#editsinbody",data:{prname:fac.getprname(),editsindata:t.com_pro.data.datalist[a].sinchl.datalist[i],com_em:{status:0,data:[],params:{},watch:{time:0}}},methods:{comsave:function(){e.com_em.before=function(t){return t.editsindata.sname?t.editsindata.cengshu?(t.com_em.params=t.editsindata,void(t.com_em.params.lastupdate=fac.time()/1e3)):(fac.showlip("工程层数不能为空"),!1):(fac.showlip("工程名称不能为空"),!1)},e.com_em.done=function(t,e){fac.dore(e,"gether")},e.com_em.watch.time=fac.time()}}});fac.ysfetch(e,"com_em"),setTimeout(function(){fac.newWebupload("headerupload","#localPicker4",function(t,a){fac.bigload(0,"上传中…"),1==a.code&&(e.editsindata.sinimg=a.url)},function(t){console.log("error")})},300)}var e=fac.getstore("sitedata"),a=e.proindex,i=e.sinindex;fac.afterloaddo(mainvue,t)},work:function(){function t(t){var e=fac.getstore("sitedata"),a=e.proindex,i=e.sinindex,n=new Vue({el:"#workpro",data:{prosta:!1,sinsta:!1,sinindex:i,proindex:a,showtype:0,tap:0,ld:0,prodata:t.com_pro.data.datalist,prname:fac.getprname(),sname:fac.getsname(),work_image:{status:0,data:[],params:{},watch:{time:0}},work_matcount:{status:0,data:[],params:{},watch:{time:0}}},methods:{changeopen:fac.changeopen,checkpro:function(t){this.proindex=t,this.prosta=!1,this.sinsta=!0,this.sname=""},changetap:function(t){this.tap=t;var e=this.showtype,a=this;setTimeout(function(){if(1==t){var i=[a.work_image.data.quanbu,a.work_image.data.jichu,a.work_image.data.zhuti],n=["","-基础","-主体"],o=fac.getstore("sitedata"),s=o.sname,c=s+n[t]+"- 送检统计图";fac.hntchart(i[e],c)}2==t&&fac.domatchart(a.work_matcount.data,"工程原材送检统计图")},200)},checksin:function(t){this.showtype=0,this.sinindex=t,this.prname=this.prodata[this.proindex].prname,this.sname=this.prodata[this.proindex].sinchl.datalist[this.sinindex].sname;var e=fac.getstore("sitedata");e.prcodeid=this.prodata[this.proindex].codeid,e.scodeid=this.prodata[this.proindex].sinchl.datalist[this.sinindex].codeid,e.prname=this.prname,e.sname=this.sname,fac.setstore("sitedata",e),this.sinsta=!1,this.prosta=!1,fac.changeopen("#workpro","all"),setTimeout(function(){n.work_image.watch.time=fac.time(),n.work_matcount.watch.time=fac.time()},200)},gettype:function(t,e){return 0==t||e==t+2},changeshowtype:function(t){if(this.showtype=t,1==this.tap){var e=[this.work_image.data.quanbu,this.work_image.data.jichu,this.work_image.data.zhuti],a=["","-基础","-主体"],i=fac.getstore("sitedata"),n=i.sname,o=n+a[t]+"- 送检统计图";fac.hntchart(e[t],o)}}}});fac.ysfetch(n,"work_image"),fac.ysfetch(n,"work_matcount"),n.work_matcount.before=function(t){fac.bigload(1);var e=fac.getstore("sitedata");return""==e.prcodeid?(fac.bigload(0),!1):void(t.work_matcount.params={codeid:e.prcodeid})},n.work_matcount.done=function(t){setTimeout(function(){fac.bigload(0)},500)},n.work_matcount.watch.time=fac.time(),n.work_image.before=function(t){fac.bigload(1);var e=fac.getstore("sitedata");return""==e.scodeid?(fac.bigload(0),!1):void(t.work_image.params={codeid:e.scodeid})},n.work_image.done=function(t){setTimeout(function(){fac.bigload(0)},1e3);var e=fac.getstore("sitedata"),a=e.sname,i=[t.work_image.data.quanbu,t.work_image.data.jichu,t.work_image.data.zhuti],n=["","-基础","-主体"],o=a+n[0]+"- 送检统计图";
fac.hntchart(i[0],o)},n.work_image.watch.time=fac.time()}fac.bigload(1),setTimeout(function(){fac.afterloaddo(mainvue,t)},300)},plan:function(){function t(t){fac.setstore("pagetap","plan");var e=fac.getsname(),a=0,i=fac.getstore("sitedata"),n=i.proindex;i.sinindex;t.com_pro.data.datalist.length>0&&0==t.com_pro.data.datalist[n].sinchl.datalist.length&&(fac.showlip("请先回到首页，创建子单位"),e="原材",a=1),window.planvm=new Vue({el:"#plantop",data:{sitedata:fac.getstore("sitedata"),prosta:!1,sinsta:!1,sinindex:0,proindex:0,sinmat:a,stype:"by",yctype:1,showdel:0,esta:0,sheet:!1,stp:{by:"标养",ty:"同养",ks:"抗渗",zt:"柱头",dz:"焊接",qz:"砌筑",wq:"外墙",nq:"内墙",zp:"找平"},prodata:t.com_pro.data.datalist,prname:fac.getprname(),sname:e,plan_mat:{status:0,data:[],params:{},watch:{time:0},before:function(t){fac.bigload(1);var e=fac.getstore("sitedata");t.plan_mat.params={codeid:e.prcodeid,yctype:t.yctype}},done:function(t,e){setTimeout(function(){fac.bigload(0)},600)}},plan_songjian:{status:0,data:[],params:{},watch:{time:0},before:function(t){fac.bigload(1);var e=fac.getstore("sitedata");t.plan_songjian.params={codeid:e.scodeid,type:t.stype}},done:function(t,e){var a=e.data.datalist;e.code>0&&(e.data.datalist=a.sort(function(t,e){return t.myorder-e.myorder})),t.plan_songjian.data=e.data,setTimeout(function(){fac.bigload(0)},600)}},com_ed:{status:0,data:[],params:{},watch:{time:0}},com_em:{status:0,data:[],params:{},watch:{time:0}},com_ea:{status:0,data:[],params:{},watch:{time:0}}},methods:{setcodeid:fac.setcodeid,yschk:fac.yschk,changeopen:fac.changeopen,setasta:function(){this.esta=this.esta?0:1},lq:function(t,e,a){var i=1==a?fac.time(e):fac.time(),n=parseInt((i-fac.time(t))/864e5);return n+="天"},selectitem:function(t,e){t.check=0==t.check?1:0;var a=0;e.map(function(t){var e=t.check?t.check:0;a+=e}),this.showdel=a},selectall:function(t){var e=1;t.length==this.showdel?(e=0,this.showdel=0):this.showdel=t.length,t.map(function(t){t.check=e})},ornotchk:function(t){var e=this.stype+"ornot",a={};a[e]=1==t[e]?0:1,a.codeid=t.codeid,planvm.com_em.before=function(t){t.com_em.params=a},planvm.com_em.done=function(i,n){1==n.code?(t[e]=a[e],$.toptip("保存成功","success")):$.toptip("更新失败","error")},planvm.com_em.watch.time=fac.time()},checksj:function(t){this.stype=t,this.showdel=0,this.esta=0,this.plan_songjian.watch.time=fac.time()},checkmat:function(t){this.yctype=t,this.plan_mat.watch.time=fac.time()},checkpro:function(t){this.proindex=t,this.prosta=!1,this.sinsta=!0,this.sname=""},shwosheet:function(){this.sheet=!this.sheet,this.sheet?$("#iosMasktwo").fadeIn(200):$("#iosMasktwo").fadeOut(200)},comdel:function(t){var e=this;$("#iosDialog1").fadeIn(200),$("#iosDialog1").find("#diatext").html("确定要删除选中项么？"),$(".dialogsyes").on("click",function(){$(this).parents(".js_dialog").fadeOut(200);var a=[];t.map(function(t){1==t.check&&0==t.isdel&&a.push(t.codeid)}),a.length>0&&(planvm.com_ed.before=function(t){t.com_ed.params={codeid:a}},planvm.com_ed.done=function(a,i){e.showdel=0,1==i.code?(t.map(function(t){1==t.check&&(t.isdel=1)}),$.toptip("保存成功","success")):$.toptip("更新失败","error")},planvm.com_ed.watch.time=fac.time())}),$(".dialogsno").on("click",function(){$(this).parents(".js_dialog").fadeOut(200)})},comadd:function(t){var e=["原材名称","钢筋","水泥","砂","砖","装饰","节能","防水","水电","安全"],a={},i=fac.getstore("sitedata");0==this.sinmat?(a.prcodeid=i.prcodeid,a.codeid=this.plan_songjian.data.codeid,a.scodeid=i.scodeid,a.bybuwei="部位-新增",a.byys=0,a.byornot=1,a.tyornot=0,a.ksornot=0,a.ztornot=0,a.cmornot=0,a.dzornot=0,a.qzornot=0,a.wqornot=0,a.nqornot=0,a.zpornot=0):(a.prcodeid=i.prcodeid,a.codeid=this.plan_mat.data.codeid,a.yctype=this.yctype,a.mname=e[this.yctype]+"-新增",a.ycys=0),a.isdel=0,a.check=0,this.com_ea.before=function(t){t.com_ea.params=a,$("#test").html(JSON.stringify(a))},this.com_ea.done=function(e,i){1==i.code?(a.codeid=i.data.codeid,delete a.prcodeid,delete a.scodeid,t.unshift(a),$.toptip("添加成功","success")):$.toptip("添加失败","error")},this.com_ea.watch.time=fac.time()},checksin:function(t){this.showdel=0,this.prname=this.prodata[this.proindex].prname;var e=fac.getstore("sitedata");e.prcodeid=this.prodata[this.proindex].codeid,e.prname=this.prname,"A"!=t?(this.sinmat=0,this.sinindex=t,this.sname=this.prodata[this.proindex].sinchl.datalist[this.sinindex].sname,e.scodeid=this.prodata[this.proindex].sinchl.datalist[this.sinindex].codeid,e.sname=this.sname,this.plan_songjian.watch.time=fac.time()):(this.sinmat=1,this.sname="原材",e.scodeid="",e.sname=this.sname,this.plan_mat.watch.time=fac.time()),fac.setstore("sitedata",e),this.sinsta=!1,this.prosta=!1,fac.changeopen("#plantop","all")}}}),fac.ysfetch(planvm,"plan_songjian"),fac.ysfetch(planvm,"plan_mat"),fac.ysfetch(planvm,"com_ed"),fac.ysfetch(planvm,"com_ea"),fac.ysfetch(planvm,"com_em"),setTimeout(function(){1==a?planvm.plan_mat.watch.time=fac.time():planvm.plan_songjian.watch.time=fac.time()},300)}fac.bigload(1),fac.afterloaddo(mainvue,t)},yc:function(){var t={el:"#ycbody",data:{yctypelist:YSCONF.ext.yctypelist,ftypelist:YSCONF.ext.ftypelist,yc_info:{status:0,data:{},params:{},watch:{time:0},done:fac.done},com_em:{status:0,data:{},params:{},watch:{time:0}}},methods:{dozushu:fac.dozushu,spl:fac.spl,comsave:function(){var t=[];$('input[name="ccph"]').each(function(e,a){t.push(a.value)});var a=[];$('input[name="ypbh"]').each(function(t,e){a.push(e.value)});var i=[];$('input[name="jieguo"]').each(function(t,e){i.push(e.value)}),e.com_em.before=function(e){e.yc_info.data.ccph=t.join(","),e.yc_info.data.jieguo=i.join(","),e.yc_info.data.ypbh=a.join(","),e.com_em.params=e.yc_info.data,e.com_em.params.lastupdate=fac.time()/1e3},e.com_em.done=function(t,e){var a=fac.getstore("pagetap");"plan"==a&&(planvm.plan_mat.watch.time=fac.time()),fac.dore(e,a)},e.com_em.watch.time=fac.time()}}},e=new Vue(t);fac.ysfetch(e,"yc_info"),fac.ysfetch(e,"com_em"),e.yc_info.before=function(t){fac.bigload(1),t.yc_info.params={codeid:fac.getstore("wecodeid")}},e.yc_info.watch.time=fac.time()},sj:function(){var t={el:"#bybody",data:{stype:fac.getstore("stype"),stp:{by:"标养",ty:"同养",ks:"抗渗",zt:"柱头",dz:"焊接",qz:"砌筑",wq:"外墙",nq:"内墙",zp:"找平"},fenbudata:[{title:"基础",t:"3"},{title:"主体",t:"4"},{title:"装修",t:"5"},{title:"幕墙",t:"6"},{title:"屋面",t:"7"},{title:"节能",t:"8"},{title:"给排水",t:"9"},{title:"电气",t:"10"}],showcheck:0,fenbuarr:[],by_info:{status:0,data:{},params:{},watch:{time:0},done:fac.done},com_em:{status:0,data:{},params:{},watch:{time:0}}},methods:{dozushu:fac.dozushu,spl:fac.spl,yongchange:function(){var t=this.by_info.data.byyl;this.by_info.data.byzushu=t>=1e3?Math.ceil(t/200):Math.ceil(t/100)},fenbumore:function(e,a,i){var n="ad"+i,o=$("#"+n).is(":checked");o?t.data.by_info.data.fid.push(a):t.data.by_info.data.fid=$.grep(t.data.by_info.data.fid,function(t){return t!=a})},ischk:function(t,e){if(e){var a=!1;return e.map(function(e){e==t&&(a=!0)}),a}return!1},riqichange:function(t){if("by"==t||"ty"==t||"ks"==t||"zt"==t||"cm"==t){var e=fac.time(this.by_info.data.byriqi),a=e+24192e5,i=e+2592e6,n=e+6048e5;this.by_info.data.bytime=fac.numtotime(a),this.by_info.data.zttime=fac.numtotime(a),this.by_info.data.kstime=fac.numtotime(i),this.by_info.data.cmtime=fac.numtotime(n)}if("dz"==t&&(this.by_info.data.dztime=this.by_info.data.dzriqi),"qz"==t||"wq"==t||"nq"==t||"zp"==t){var o=t+"riqi",s=fac.time(this.by_info.data[o]),c=s+24192e5,d=t+"time";this.by_info.data[d]=fac.numtotime(c)}},comsave:function(){var a=this,i=this.stype+"bh",n=[];$("input[name="+i+"]").each(function(t,e){n.push(e.value)});var o=this.stype+"jg",s=[];$("input[name="+o+"]").each(function(t,e){s.push(e.value)}),e.com_em.before=function(e){if(e.by_info.data[i]=n.join(","),e.by_info.data[o]=s.join(","),e.by_info.data.fid=t.data.by_info.data.fid.join(","),"by"==a.stype||"ty"==a.stype||"zt"==a.stype){var c=a.stype+"xinpian",d=[];$("input[name="+c+"]").each(function(t,e){d.push(e.value)}),e.by_info.data[c]=d.join(",")}if("dz"==a.stype){var r=[];$('input[name="dzpaihao"]').each(function(t,e){r.push(e.value)}),e.by_info.data.dzpaihao=r.join(",");var m=[];$('input[name="dzchangjia"]').each(function(t,e){m.push(e.value)}),e.by_info.data.dzchangjia=m.join(",");var f=[];$('input[name="dzguige"]').each(function(t,e){f.push(e.value)}),e.by_info.data.dzguige=f.join(",")}e.com_em.params=e.by_info.data,e.com_em.params.lastupdate=fac.time()/1e3},e.com_em.done=function(t,e){var a=fac.getstore("pagetap");"plan"==a&&(planvm.plan_songjian.watch.time=fac.time()),fac.dore(e,a)},e.com_em.watch.time=fac.time()}}},e=new Vue(t);fac.ysfetch(e,"by_info"),fac.ysfetch(e,"com_em"),e.by_info.before=function(t){fac.bigload(1),t.by_info.params={codeid:fac.getstore("wecodeid"),type:e.stype}},e.by_info.done=function(t,e){},e.by_info.watch.time=fac.time()},wendu:function(){var t={el:"#wendubody",data:{wendu_info:{status:0,data:{tyinfo:{bybuwei:"",city:""},datalist:[]},params:{},watch:{time:0},done:fac.done}},methods:{fanhui:function(){window.pageManager.back("sj")}}},e=new Vue(t);fac.ysfetch(e,"wendu_info"),e.wendu_info.before=function(t){fac.bigload(1),t.wendu_info.params={codeid:fac.getstore("wecodeid"),type:"ty"}},e.wendu_info.watch.time=fac.time()},base:function(){function t(t){new Vue({el:"#base",data:{prosta:!1,sinsta:!1,proindex:a,prname:i,prodata:t.com_pro.data.datalist},methods:{changeopen:fac.changeopen,checkpro:function(t){this.proindex=t,this.prosta=!1,fac.changeopen("#base","all");var e=fac.getstore("sitedata");this.prname=this.prodata[t].prname,e.prname=this.prname,e.prcodeid=this.prodata[t].codeid,this.prodata[t].sinchl.datalist.length>0?(e.sname=this.prodata[t].sinchl.datalist[0].sname,e.scodeid=this.prodata[t].sinchl.datalist[0].codeid):(e.sname="",e.scodeid=""),fac.setstore("sitedata",e)}}})}var e=fac.getstore("sitedata"),a=e.proindex,i=e.prname;fac.afterloaddo(mainvue,t)},jiben:function(){var t={el:"#jibenbody",data:{sitedata:{name:"123123"},com_province:{status:0,data:{},params:{},watch:{time:0}},com_city:{status:0,data:{},params:{},watch:{time:0}},jiben:{status:0,data:{pid:"11",cityid:"23"},params:{},watch:{time:0}},com_em:{status:0,data:[],params:{},watch:{time:0}}},methods:{comsave:function(){e.com_em.before=function(t){return e.jiben.data.prname?e.jiben.data.cityid?e.jiben.data.jiegou?e.jiben.data.kaigong>e.jiben.data.jungong?(fac.showlip("竣工日期必须大于开工日期！"),!1):(t.com_em.params=e.jiben.data,void(t.com_em.params.lastupdate=fac.time()/1e3)):(fac.showlip("请选择结构"),!1):(fac.showlip("请选择城市"),!1):(fac.showlip("请填写工程名称"),!1)},e.com_em.done=function(t,e){fac.dore(e,"gether")},e.com_em.watch.time=fac.time()},selpro:function(a){var i=a.target.value;this.jiben.data.pid=i,e.com_city.before=function(t){t.com_city.params.pid=i},t.data.jiben.data.cityid&&(t.data.jiben.data.cityid=""),e.com_city.watch.time=fac.time()},selcity:function(t){this.jiben.data.cityid=t.target.value}}},e=new Vue(t);fac.ysfetch(e,"jiben"),fac.ysfetch(e,"com_em"),fac.ysfetch(e,"com_province"),fac.ysfetch(e,"com_city"),e.jiben.before=function(t){var e=fac.getstore("sitedata");t.jiben.params={codeid:e.prcodeid}},e.jiben.done=function(t,a){e.com_province.watch.time=fac.time(),e.com_city.before=function(t){t.com_city.params={pid:a.data.pid}},e.com_city.watch.time=fac.time()},setTimeout(function(){fac.newWebupload("headerupload","#localPicker2",function(t,a){fac.bigload(0,"上传中…"),1==a.code&&(e.jiben.data.proimg=a.url)},function(t){console.log("error")}),e.jiben.watch.time=fac.time()},300)},jishu:function(){var t={el:"#jishu_news",data:{sitedata:{name:"12"},jishu_info:{status:0,data:[{prname:"11"}],params:{codeid:4},watch:{time:0}},com_em:{status:0,data:[],params:{},watch:{time:0}}},methods:{comsave:function(){e.com_em.before=function(t){t.com_em.params=e.jishu_info.data,t.com_em.params.lastupdate=fac.time()/1e3},e.com_em.done=function(t,e){fac.dore(e,"gether")},e.com_em.watch.time=fac.time()}}},e=new Vue(t);fac.ysfetch(e,"jishu_info"),fac.ysfetch(e,"com_em"),e.jishu_info.before=function(t){var e=fac.getstore("sitedata");t.jishu_info.params={codeid:e.prcodeid}},e.jishu_info.watch.time=fac.time()},shigong:function(){var t={el:"#shi_gong",data:{sitedata:{name:"12"},shigong_unit:{status:0,data:[{prname:"11"}],params:{codeid:4},watch:{time:0}},com_em:{status:0,data:[],params:{},watch:{time:0}}},methods:{comsave:function(){e.com_em.before=function(t){t.com_em.params=e.shigong_unit.data,t.com_em.params.lastupdate=fac.time()/1e3},e.com_em.done=function(t,e){fac.dore(e,"gether")},e.com_em.watch.time=fac.time()}}},e=new Vue(t);fac.ysfetch(e,"shigong_unit"),fac.ysfetch(e,"com_em"),e.shigong_unit.before=function(t){var e=fac.getstore("sitedata");t.shigong_unit.params={codeid:e.prcodeid}},e.shigong_unit.watch.time=fac.time()},jianshe:function(){var t={el:"#jian_she",data:{sitedata:{name:"12"},jianshe_unit:{status:0,data:[{prname:"11"}],params:{codeid:4},watch:{time:0}},com_em:{status:0,data:[],params:{},watch:{time:0}}},methods:{comsave:function(){e.com_em.before=function(t){t.com_em.params=e.jianshe_unit.data,t.com_em.params.lastupdate=fac.time()/1e3},e.com_em.done=function(t,e){fac.dore(e,"gether")},e.com_em.watch.time=fac.time()}}},e=new Vue(t);fac.ysfetch(e,"jianshe_unit"),fac.ysfetch(e,"com_em"),e.jianshe_unit.before=function(t){var e=fac.getstore("sitedata");t.jianshe_unit.params={codeid:e.prcodeid}},e.jianshe_unit.watch.time=fac.time()},jianli:function(){var t={el:"#jian_li",data:{sitedata:{name:"12"},jianli_unit:{status:0,data:[{prname:"11"}],params:{codeid:4},watch:{time:0}},com_em:{status:0,data:[],params:{},watch:{time:0}}},methods:{comsave:function(){e.com_em.before=function(t){t.com_em.params=e.jianli_unit.data,t.com_em.params.lastupdate=fac.time()/1e3},e.com_em.done=function(t,e){fac.dore(e,"gether")},e.com_em.watch.time=fac.time()}}},e=new Vue(t);fac.ysfetch(e,"jianli_unit"),fac.ysfetch(e,"com_em"),e.jianli_unit.before=function(t){var e=fac.getstore("sitedata");t.jianli_unit.params={codeid:e.prcodeid}},e.jianli_unit.watch.time=fac.time()},sheji:function(){var t={el:"#she_ji",data:{sitedata:{name:"12"},sheji_unit:{status:0,data:[{prname:"11"}],params:{codeid:4},watch:{time:0}},com_em:{status:0,data:[],params:{},watch:{time:0}}},methods:{comsave:function(){e.com_em.before=function(t){t.com_em.params=e.sheji_unit.data,t.com_em.params.lastupdate=fac.time()/1e3},e.com_em.done=function(t,e){fac.dore(e,"gether")},e.com_em.watch.time=fac.time()}}},e=new Vue(t);fac.ysfetch(e,"sheji_unit"),fac.ysfetch(e,"com_em"),e.sheji_unit.before=function(t){var e=fac.getstore("sitedata");t.sheji_unit.params={codeid:e.prcodeid}},e.sheji_unit.watch.time=fac.time()},kancha:function(){var t={el:"#kan_cha",data:{sitedata:{name:"12"},kancha:{status:0,data:[{prname:"11"}],params:{codeid:4},watch:{time:0}},com_em:{status:0,data:[],params:{},watch:{time:0}}},methods:{comsave:function(){e.com_em.before=function(t){t.com_em.params=e.kancha.data,t.com_em.params.lastupdate=fac.time()/1e3},e.com_em.done=function(t,e){fac.dore(e,"gether")},e.com_em.watch.time=fac.time()}}},e=new Vue(t);fac.ysfetch(e,"kancha"),fac.ysfetch(e,"com_em"),e.kancha.before=function(t){var e=fac.getstore("sitedata");t.kancha.params={codeid:e.prcodeid}},e.kancha.watch.time=fac.time()},qita:function(){var t={el:"#other_q",data:{sitedata:{name:"12"},othera_unit:{status:0,data:[{prname:"11"}],params:{codeid:4},watch:{time:0}},com_em:{status:0,data:[],params:{},watch:{time:0}}},methods:{comsave:function(){e.com_em.before=function(t){t.com_em.params=e.othera_unit.data,t.com_em.params.lastupdate=fac.time()/1e3},e.com_em.done=function(t,e){fac.dore(e,"gether")},e.com_em.watch.time=fac.time()}}},e=new Vue(t);fac.ysfetch(e,"othera_unit"),fac.ysfetch(e,"com_em"),e.othera_unit.before=function(t){var e=fac.getstore("sitedata");t.othera_unit.params={codeid:e.prcodeid}},e.othera_unit.watch.time=fac.time()},gether:function(){function t(t){fac.setstore("pagetap","gether");var e=new Vue({el:"#getherbody",data:{prosta:!1,sinsta:!1,sinindex:0,proindex:0,prodata:t.com_pro.data.datalist,prname:fac.getprname(),sname:fac.getsname(),lsornot:!0,btime:"",etime:"",gether_data:{status:0,data:{by:{hzlist:[],lslist:[]},ty:{hzlist:[],lslist:[]},ks:{hzlist:[],lslist:[]},zt:{hzlist:[],lslist:[]},cm:{hzlist:[],lslist:[]},dz:{hzlist:[],lslist:[]},qz:{hzlist:[],lslist:[]},wq:{hzlist:[],lslist:[]},nq:{hzlist:[],lslist:[]},zp:{hzlist:[],lslist:[]},yc:{hzlist:[],lslist:[]}},params:{},watch:{time:0},done:fac.done},gether_save:{status:0,params:{},watch:{time:0},done:fac.done}},created:function(){this.btime=fac.numtotime((new Date).getTime()),this.etime=fac.numtotime((new Date).getTime()+6048e5)},methods:{yschk:fac.yschk,changeopen:fac.changeopen,find:function(){return e.etime<e.btime?($.toptip("结束日期必须大于起始日期","error"),!1):(this.sinsta=!1,fac.changeopen("#getherbody","all"),fac.bigload(1),void setTimeout(function(){e.gether_data.watch.time=fac.time()},230))},saveasjilu:function(){$("#iosDialog1").fadeIn(200),$("#iosDialog1").find("#diatext").html("确定存为快照，以便在送检快照中查阅？（请通过电脑端查阅）"),$(".dialogsyes").unbind(),$(".dialogsyes").on("click",function(){$(this).parents(".js_dialog").fadeOut(200),e.gether_save.done=function(t,e){1==e.code?$.toptip("送检快照已经成功保存；","success"):$.toptip("保存失败！","error")},e.gether_save.before=function(t){var e=fac.getstore("sitedata");t.gether_save.params={codeid:e.prcodeid,btime:t.btime,etime:t.etime}},e.gether_save.watch.time=fac.time()}),$(".dialogsno").on("click",function(){$(this).parents(".js_dialog").fadeOut(200)})},checkpro:function(t){this.proindex=t,this.prosta=!1,fac.changeopen("#getherbody","all");var a=fac.getstore("sitedata");this.prname=this.prodata[t].prname,a.prname=this.prname,a.prcodeid=this.prodata[t].codeid,this.prodata[t].sinchl.datalist.length>0?(a.sname=this.prodata[t].sinchl.datalist[0].sname,a.scodeid=this.prodata[t].sinchl.datalist[0].codeid):(a.sname="",a.scodeid=""),fac.setstore("sitedata",a),fac.bigload(1),setTimeout(function(){e.gether_data.watch.time=fac.time()},200)},setcodeid:fac.setcodeid}});fac.ysfetch(e,"gether_save"),fac.ysfetch(e,"gether_data"),e.gether_data.before=function(t){fac.bigload(1);var e=fac.getstore("sitedata");t.gether_data.params={codeid:e.prcodeid,btime:t.btime,etime:t.etime}},e.gether_data.watch.time=fac.time()}fac.bigload(1),setTimeout(function(){fac.afterloaddo(mainvue,t)},200)},addpro:function(){var t=new Vue({el:"#probody",data:{pro_add:{status:0,data:{prname:"",pid:"",cityid:"",jiegou:"",kaigong:"",jungong:"",proimg:""},params:{},watch:{time:0}},com_province:{status:0,data:{},params:{},watch:{time:0}},com_city:{status:0,data:{},params:{},watch:{time:0}}},methods:{selprovince:function(e){t.pro_add.data.cityid&&(t.pro_add.data.cityid=""),this.com_city.before=function(t){t.com_city.params.pid=e},this.com_city.watch.time=fac.time()},savepro:function(){t.pro_add.before=function(e){return e.pro_add.params=t.pro_add.data,""==e.pro_add.params.prname?($.toptip("工程名称不能为空!","warning"),!1):""==e.pro_add.params.pid?($.toptip("请选择省份!","warning"),!1):e.pro_add.params.cityid?""==e.pro_add.params.jiegou?($.toptip("请选择框架类型!","warning"),!1):""==e.pro_add.params.kaigong?($.toptip("请选择开工日期!","warning"),!1):""==e.pro_add.params.jungong?($.toptip("请选择竣工日期日期!","warning"),!1):fac.time(e.pro_add.params.jungong)<=fac.time(e.pro_add.params.kaigong)?($.toptip("竣工日期必须大于开工日期","warning"),!1):void fac.bigload(1):($.toptip("请选择城市!","warning"),!1)},t.pro_add.done=function(t,e){fac.bigload(0),mainvue.com_pro.done=function(t,e){homevm.prodata=t.com_pro.data.datalist,fac.setcode(t)},mainvue.com_pro.watch.time=fac.time(),fac.dore(e,"sin")},t.pro_add.watch.time=fac.time()}}});fac.ysfetch(t,"pro_add"),fac.ysfetch(t,"com_province"),fac.ysfetch(t,"com_city"),setTimeout(function(){fac.newWebupload("headerupload","#localPicker",function(e,a){fac.bigload(0,"上传中…"),1==a.code&&(t.pro_add.data.proimg=a.url)},function(t){console.log("error")}),t.com_province.watch.time=fac.time()},300)},gether:function(){},gether:function(){},gether:function(){}};